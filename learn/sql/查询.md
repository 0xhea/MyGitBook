
# 查询

## 基础查询

```mysql
SELECT 查询列表 FROM 表名;
```

1. 查询列表可以是字段、常量、表达式、函数，也可以是多个
2. 查询结果是一个虚拟表

### 查询表中的字段

```mysql
SELECT 字段名 FROM 表名;
SELECT 字段名，字段名 FROM 表名;  # 查询多个字段
SELECT * FROM 表名;  # 查询所有字段
```

```mysql
SELECT 常量值;  # 常量
SELECT 函数名(实参列表);  # 函数
SELECT 100/1234;  # 表达式
```


注意：字符型和日期型的常量值必须用单引号引起来，数值型不需要。

### 起别名 (AS, 空格)
```mysql
SELECT last_name AS 姓,first_name AS 名 FROM employees;
SELECT last_name 姓,first_name 名 FROM employees;
```

如果要查询的字段有重名的情况，使用别名可以区分开来

### 去重 distinct
`SELECT distinct 字段名 FROM 表名;`

### +号 做加法运算
```mysql
SELECT 数值+数值;  # 直接运算
SELECT 字符+数值;  # 先试图将字符转换成数值，如果转换成功，则继续运算；否则转换成0，再做运算
SELECT null+值;  # 结果都为null
```

### 补充函数

#### concat 函数

功能：拼接字符
`SELECT concat(字符1，字符2，字符3,...);`

#### ifnull 函数
功能：判断某字段或表达式是否为null，如果为null 返回指定的值，否则返回原本的值
`SELECT ifnull(commission_pct,0) FROM employees;`

#### isnull 函数
功能：判断某字段或表达式是否为null，如果是，则返回1，否则返回0.



## 条件查询

```mysql
SELECT 查询列表 FROM 表名 WHERE 筛选条件;
```

### 简单条件运算符

<	=	<>	!=	>=	<=	<=>安全等于

### 逻辑运算符

&& and

|| or

! not

### 模糊查询

#### like

```mysql
SELECT * FROM employees WHERE last_name like '%a%';
SELECT last_name FROM employees WHERE last_name LIKE '_\_%';  # 转义
SELECT last_name FROM employees WHERE last_name LIKE '_$_%' ESCAPE '$';  # ESCAPE可以用来指定转义符
```

一般搭配通配符使用，可以判断字符型或数值型

通配符：%任意多个字符，_任意单个字符

#### between and

`SELECT * FROM employees WHERE employee_id BETWEEN 120 AND 100;`

#### in

`SELECT last_name, job_id FROM employees WHERE job_id IN( 'IT_PROT' ,'AD_VP','AD_PRES');`

#### is null / is not null

`SELECT last_name, commission_pct FROM employees WHERE commission_pct IS NOT NULL;`

=或<>不能用于判断null值，is null或is not null 可以判断null值

|              | 普通类型的数值 | null值 | 可读性 |
| ------------ | -------------- | ------ | ------ |
| is null      | ×              | √      | √      |
| <=> 安全等于 | √              | √      | ×      |



## 排序查询

```mysql 
SELECT 查询列表 FROM 表 [WHERE 筛选条件] ORDER BY 排序列表 [ASC/DESC]
```

1. asc升序，desc降序，默认升序；
2. order by 子句可以支持单个字段、多个字段、表达式、函数、别名；
3. order by 子句一般是放在查询语句的最后面，limit子句除外。

```mysql
SELECT * FROM employees WHERE department_id >= 90 ORDER BY hiredate ASC;

# 按表达式排序
SELECT *, salary * 12 * (1 + IFNULL(commission_pct, 0)) AS 年薪 FROM employees 
ORDER BY salary * 12 * (1 + IFNULL(commission_pct, 0)) ASC;
# 按别名排序
SELECT *, salary * 12 * (1 + IFNULL(commission_pct, 0)) AS 年薪 FROM employees 
ORDER BY 年薪 ASC;

# 按函数排序
SELECT LENGTH(last_name) AS 姓名长度, last_name, salary FROM employees 
ORDER BY LENGTH(last_name) DESC;

# 按多个字段排序
SELECT * FROM employees ORDER BY salary ASC, employee_id DESC;
```



## 常见函数

```mysql
SELECT 函数名(实参列表) [FROM 表];
```

### 单行函数

#### 字符函数

1. length 获取字节长度（utf8一个中文三个字节）
2. concat 拼接字符串
3. upper / lower 字符串全大写/小写
4. substr substring 截取字符串（索引从1开始）
5. instr 返回子串在字符串中第一次出现位置的索引，如果不存在返回0
6. trim 去掉字符串首尾的字符，默认为空格 `SELECT TRIM('a' FROM 'aababaa'); #bab`
7. lpad(str, len, padstr)  在字符串左侧填充到指定长度， 如果len小于str长度，str会被右截断
   * `SELECT LPAD('zhou', 9, 'ab'); #ababazhou`
   * `SELECT LPAD('zhou', 2, 'ab'); #zh`
8. rpad(str, len, padstr) 右填充
9. replace 替换 `SELECT REPLACE('abcab', 'ab', 'de'); #decde`

#### 数学函数

1. round 四舍五入
   * ROUND(X) `SELECT ROUND(1.567); #2`
   * ROUND(X, D) `SELECT ROUND(1.567, 2); #1.57`
2. ceil(x) 向上取整，返回>=该参数的最小整数
3. floor(x) 向下取整，返回<=该参数的最小整数
4. truncate(x, d) 小数点后保留d位，直接截断
5. mod(n, m) 取余数（复数情况等价于 n-n/m*m）

#### 日期函数



#### 其他函数



#### 流程控制函数





### 分组函数（统计函数，聚合函数，组函数）

做统计使用







